<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script></script>
    <title>Player POC</title>
  </head>
  <body>
    <div data-video-src="https://bitdash-a.akamaihd.net/content/MI201109210084_1/m3u8s/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.m3u8" ></div>
    <script type="module" src="./src/main.tsx"></script>
      <script>
        function doThingsWithCookies() {
        document.cookie = "foo=bar;samesite=none;secure"
      }

        async function handleCookieAccess() {
          if (!document.hasStorageAccess) {
          // This browser doesn't support the Storage Access API
          // so let's just hope we have access!
          doThingsWithCookies();
        } else {
          const hasAccess = await document.hasStorageAccess();
          if (hasAccess) {
          // We have access to third-party cookies, so let's go
          doThingsWithCookies();
        } else {
          // Check whether third-party cookie access has been granted
          // to another same-site embed
          try {
          const permission = await navigator.permissions.query({
          name: "storage-access",
        });

          if (permission.state === "granted") {
          // If so, you can just call requestStorageAccess() without a user interaction,
          // and it will resolve automatically.
          await document.requestStorageAccess();
          doThingsWithCookies();
        } else if (permission.state === "prompt") {
          // Need to call requestStorageAccess() after a user interaction
          document.addEventListener("click", async () => {
          try {
          await document.requestStorageAccess();
          doThingsWithCookies();
        } catch (err) {
          // If there is an error obtaining storage access.
          console.error(`Error obtaining storage access: ${err}.
                            Please sign in.`);
        }
        });
        } else if (permission.state === "denied") {
          // User has denied third-party cookie access, so we'll
          // need to do something else
        }
        } catch (error) {
          console.log(`Could not access permission state. Error: ${error}`);
          doThingsWithCookies(); // Again, we'll have to hope we have access!
        }
        }
        }
        }

        handleCookieAccess().then(() => console.log("it worked")).catch((err) => console.log(err))
    </script>
  </body>
</html>
